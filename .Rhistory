datetime="datetime",
biomet_vars=c("Ta_f", "Ts_f", "WTD_f", "PARin_f", "Ts1","Ts2","Ts3","Ts4","Ts5"),
aggr_fun=c("mean","mean","mean","sum", "mean","mean","mean","mean","mean"),
na.rm=TRUE)
names(deg_met_aggr) <- aggr_vars
saveRDS(deg_met_aggr, "D:/EC/Data_organized/Degero/FINAL/aggr_biomet.RDS")
gapfilling_list_sto <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/gf_rds.RDS")
gapfilling_list_sto$site_df[gapfilling_list_sto$site_df$PARin_f<0,"PARin_f"] <- 0
aggr_vars <- c("hour","day","week","month","year","growing_season")
sto_met_aggr <- lapply(aggr_vars, FUN=biomet_aggregator,
df=gapfilling_list_sto$site_df,
datetime="datetime",
biomet_vars=c("Ta_f", "Ts_f", "WTD_f", "PARin_f", "SNOWd", "Ts1","Ts2","Ts3","Ts4","Ts5"),
aggr_fun=c("mean","mean","mean","sum","mean",  "mean","mean","mean","mean","mean"),
na.rm=TRUE)
names(sto_met_aggr) <- aggr_vars
saveRDS(sto_met_aggr, "D:/EC/Data_organized/Stortjarn/FINAL/aggr_biomet.RDS")
gapfilling_list_hals <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/gf_rds.RDS")
gapfilling_list_hals$site_df[gapfilling_list_hals$site_df$PARin_f<0,"PARin_f"] <- 0
aggr_vars <- c("hour","day","week","month","year","growing_season")
hals_met_aggr <- lapply(aggr_vars, FUN=biomet_aggregator,
df=gapfilling_list_hals$site_df,
datetime="datetime",
biomet_vars=c("Ta_f", "Ts_f", "WTD_f", "PARin_f", "SNOWd", "Ts1","Ts2","Ts3","Ts4","Ts5"),
aggr_fun=c("mean","mean","mean","sum","mean", "mean","mean","mean","mean","mean"),
na.rm=TRUE)
names(hals_met_aggr) <- aggr_vars
saveRDS(hals_met_aggr, "D:/EC/Data_organized/Halsingfors/FINAL/aggr_biomet.RDS")
hals_met_aggr
library(devtools)
load_all()
library(dplyr)
library(lubridate)
library(zoo)
library(ggpubr)
#Halmyran
halm_aggr_ch4 <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/aggr_rds.RDS")
halm_aggr_biomet <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/aggr_biomet.RDS")
halm_aggr_co2 <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/CO2/aggr_rds_CO2.RDS")
halm_aggr_h2o <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/H2O/aggr_rds_H2O.RDS")
#Degero
deg_aggr_ch4 <- readRDS("D:/EC/Data_organized/Degero/FINAL/aggr_rds.RDS")
deg_aggr_biomet <- readRDS("D:/EC/Data_organized/Degero/FINAL/aggr_biomet.RDS")
deg_aggr_co2 <- readRDS("D:/EC/Data_organized/Degero/FINAL/CO2/aggr_rds_CO2.RDS")
deg_aggr_h2o <- readRDS("D:/EC/Data_organized/Degero/FINAL/H2O/aggr_rds_H2O.RDS")
#Stortjarn
sto_aggr_ch4 <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/aggr_rds.RDS")
sto_aggr_biomet <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/aggr_biomet.RDS")
sto_aggr_co2 <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/CO2/aggr_rds_CO2.RDS")
sto_aggr_h2o <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/H2O/aggr_rds_H2O.RDS")
#Halsingfors
hals_aggr_ch4 <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/aggr_rds.RDS")
hals_aggr_biomet <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/aggr_biomet.RDS")
hals_aggr_co2 <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/CO2/aggr_rds_CO2.RDS")
hals_aggr_h2o <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/H2O/aggr_rds_H2O.RDS")
################################
#######Monthly anomalies########
################################
#Reading all and getting daily values
halm_month <- Reduce(function(...) merge(..., all=TRUE), list(halm_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
halm_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
halm_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
halm_aggr_biomet$month)) %>% mutate(Site="Halmyran", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
deg_month <- Reduce(function(...) merge(..., all=TRUE), list(deg_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
deg_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
deg_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
deg_aggr_biomet$month)) %>% mutate(Site="Degero", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
sto_month <- Reduce(function(...) merge(..., all=TRUE), list(sto_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
sto_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
sto_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
sto_aggr_biomet$month)) %>% mutate(Site="Stortjarn", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
hals_month <- Reduce(function(...) merge(..., all=TRUE), list(hals_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
hals_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
hals_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
hals_aggr_biomet$month)) %>% mutate(Site="Halsingfors", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
g_ch4_t1<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts1", y_col = "FCH4_sum")
g_ch4_t1
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
g_ch4_ts<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts_f", y_col = "FCH4_sum")
g_ch4_ts
g_ch4_ts4<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts4", y_col = "FCH4_sum")
g_ch4_ts4
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 50cm (°C)", x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 10cm (°C)", x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 15cm (°C)", x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
g_ch4_wtd<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "WTD  anomaly (cm)", x_col="WTD_f", y_col = "FCH4_sum")
g_ch4_wtd
g_ch4_ts<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts  anomaly (°C)", x_col="Ts_f", y_col = "FCH4_sum")
g_ch4_ts
g_ch4_ta<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ta  anomaly (°C)", x_col="Ta_f", y_col = "FCH4_sum")
g_ch4_ta
View(df)
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
?table
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
list_df
df <- Reduce(function(...) rbind(...), list_df)
if(isTRUE(full_periods_only)){
tab <- table(df$period)
df <- df[df$period %in% names(tab)[tab==12],]
}
full_periods_only=TRUE
if(isTRUE(full_periods_only)){
tab <- table(df$period)
df <- df[df$period %in% names(tab)[tab==12],]
}
tab
tab <- table(df %>% group_by(site) %>% select(period))
tab <- table(df %>% dplyr::group_by(Site) %>% dplyr::select(period))
tab
df
df <- Reduce(function(...) rbind(...), list_df)
tab <- table(df %>% dplyr::group_by(Site) %>% dplyr::select(period))
tab
names(tab)
str(tab)
table$Site
tab$Site
tab[1]
tab[2]
tab[4]
tab[5]
tab[9]
tab["Site"]
tab[[1]]
tab[[2]]
tab <- table(df)
df <- Reduce(function(...) rbind(...), list_df)
tab <- table(df)
df
tab <- table(df$period)
tab
df <- df[df$period %in% names(tab)[tab==12*length(unique(df$Site))],]
df
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
load_all()
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 10cm  anomaly (°C)", x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 15cm  anomaly (°C)", x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
cor(df)
cor(is.numeric(halm_month))
cor(as.numeric(halm_month))
View(halm_month)
cor((halm_month %>% select(-c(year,month,yearmon,Site,period))))
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period)))))
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period)))))
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), na.rm = TRUE))
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs"))
plot(Ts5~yearmon,data=halm_month)
plot(Ts5~FCH4_sum,data=halm_month)
plot(Ts5~FCH4_sum,data=hals_month)
plot(Ts4~FCH4_sum,data=hals_month)
plot(Ts5~FCH4_sum,data=sto_month)
View(cor((halm_day %>% select(-c(year,month,date,Site))), use = "complete.obs"))
View(cor((halm_day %>% select(-c(year,month,date,Site))), use = "complete.obs"))
halm_day %>% select(-c(year,month,date,Site))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
#Plotting all daily
#Reading all and getting daily values
halm_day <- Reduce(function(...) merge(..., all=TRUE), list(halm_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
halm_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
halm_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
halm_aggr_biomet$day)) %>% mutate(Site="Halmyran", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
deg_day <- Reduce(function(...) merge(..., all=TRUE), list(deg_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
deg_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
deg_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
deg_aggr_biomet$day)) %>% mutate(Site="Degero", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
sto_day <- Reduce(function(...) merge(..., all=TRUE), list(sto_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
sto_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
sto_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
sto_aggr_biomet$day)) %>% mutate(Site="Stortjarn", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(is.na(GPP_sum), na.approx(GPP_sum), GPP_sum)) %>%
mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
hals_day <- Reduce(function(...) merge(..., all=TRUE), list(hals_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
hals_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
hals_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
hals_aggr_biomet$day)) %>% mutate(Site="Halsingfors", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
g_ch4 <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="CH4 fluxes (mg. m-2. d-1)", y_col = "FCH4_sum", show_x_label = FALSE)
g_gpp <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="GPP (gC. m-2. d-1)", y_col = "GPP_sum", show_x_label = FALSE)
g_Ta <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="Ta (°C)", y_col = "Ta_f", show_x_label = FALSE)
g_Ts <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="Ts (°C)", y_col = "Ts_f", show_x_label = FALSE)
g_PAR <-plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label=bquote(PARin*({10^3}*xW.m-2)), y_col = "PARin_f", show_x_label = FALSE)
g_WTD <-plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="WTD (cm)", y_col = "WTD_f", show_x_label = TRUE)
ggarrange(g_ch4,g_gpp,g_Ta,g_Ts,g_PAR,g_WTD, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
View(halm_day)
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 50cm  anomaly (°C)", x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
g_ch4_ts3
View(cor((hals_day %>% select(-c(date,Site))), use = "complete.obs"))
g_ch4_ts4<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Ts 30cm  anomaly (°C)", x_col="Ts4", y_col = "FCH4_sum")
g_ch4_ts4
ggarrange(g_ch4,g_gpp,g_Ta,g_Ts,g_PAR,g_WTD, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
g_ch4_PARin <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly PARin anomaly (W.m-2)", x_col="PARin_f", y_col = "FCH4_sum")
g_ch4_PARin
g_ch4_wtd<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly WTD  anomaly (cm)", x_col="WTD_f", y_col = "FCH4_sum")
g_ch4_wtd
g_ch4_ts<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts  anomaly (°C)", x_col="Ts_f", y_col = "FCH4_sum")
g_ch4_ts
g_ch4_ta<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ta  anomaly (°C)", x_col="Ta_f", y_col = "FCH4_sum")
g_ch4_ta
g_ch4_ts1<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 2cm  anomaly (°C)", x_col="Ts1", y_col = "FCH4_sum")
g_ch4_ts1
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 10cm  anomaly (°C)", x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 15cm  anomaly (°C)", x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
g_ch4_ts4<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 30cm  anomaly (°C)", x_col="Ts4", y_col = "FCH4_sum")
g_ch4_ts4
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 50cm  anomaly (°C)", x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
ggarrange(g_ch4_gpp,g_ch4_ts,g_ch4_wtd,g_ch4_PARin, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png")
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=50,width=15)
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=50,width=15, units = "cm")
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=15, units = "cm")
figure <- ggarrange(g_ch4_gpp,g_ch4_ts,g_ch4_wtd,g_ch4_PARin, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
annotate_figure(figure, left = textGrob("Common y-axis", rot = 90, vjust = 1, gp = gpar(cex = 1.3)))
library(grid)
annotate_figure(figure, left = textGrob("Common y-axis", rot = 90, vjust = 1, gp = gpar(cex = 1.3)))
load_all()
load_all()
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
g_ch4_PARin <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly PARin anomaly (W.m-2)", x_col="PARin_f", y_col = "FCH4_sum")
g_ch4_PARin
g_ch4_wtd<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly WTD  anomaly (cm)", x_col="WTD_f", y_col = "FCH4_sum")
g_ch4_wtd
g_ch4_ts<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts  anomaly (°C)", x_col="Ts_f", y_col = "FCH4_sum")
g_ch4_ts
g_ch4_ta<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ta  anomaly (°C)", x_col="Ta_f", y_col = "FCH4_sum")
g_ch4_ta
g_ch4_ts1<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 2cm  anomaly (°C)", x_col="Ts1", y_col = "FCH4_sum")
g_ch4_ts1
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 10cm  anomaly (°C)", x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 15cm  anomaly (°C)", x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
g_ch4_ts4<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 30cm  anomaly (°C)", x_col="Ts4", y_col = "FCH4_sum")
g_ch4_ts4
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 50cm  anomaly (°C)", x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
figure <- ggarrange(g_ch4_gpp,g_ch4_ts,g_ch4_wtd,g_ch4_PARin, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
annotate_figure(figure, left = textGrob("Common y-axis", rot = 90, vjust = 1, gp = gpar(cex = 1.3)))
annotate_figure(figure, left = textGrob("Monthly CH4 flux anomaly (mg. m-2. d-1)", rot = 90, vjust = 1, gp = gpar(cex = 1.3)))
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=15, units = "cm")
annotate_figure(figure, left = textGrob("Monthly CH4 flux anomaly (mg. m-2. d-1)", rot = 90, vjust = 1, gp = gpar(cex = 1)))
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=15, units = "cm")
ggarrange(g_ch4,g_gpp,g_Ta,g_Ts,g_PAR,g_WTD, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
ggsave("D:/EC/Data_organized/Graphs_all/all_variables.png", height=30,width=15, units = "cm")
ggsave("D:/EC/Data_organized/Graphs_all/all_variables.png", height=30,width=25, units = "cm")
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=20, units = "cm")
figure <- ggarrange(g_ch4_gpp,g_ch4_ts,g_ch4_wtd,g_ch4_PARin, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
annotate_figure(figure, left = textGrob("Monthly CH4 flux anomaly (mg. m-2. d-1)", rot = 90, vjust = 1, gp = gpar(cex = 1)))
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=20, units = "cm")
load_all()
g_ch4_gpp <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_col="GPP_sum", y_col = "FCH4_sum")
g_ch4_gpp
g_ch4_PARin <- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly PARin anomaly (W.m-2)", x_col="PARin_f", y_col = "FCH4_sum")
g_ch4_PARin
g_ch4_wtd<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly WTD  anomaly (cm)", x_col="WTD_f", y_col = "FCH4_sum")
g_ch4_wtd
g_ch4_ts<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts  anomaly (°C)", x_col="Ts_f", y_col = "FCH4_sum")
g_ch4_ts
g_ch4_ta<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ta  anomaly (°C)", x_col="Ta_f", y_col = "FCH4_sum")
g_ch4_ta
g_ch4_ts1<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 2cm  anomaly (°C)", x_col="Ts1", y_col = "FCH4_sum")
g_ch4_ts1
g_ch4_ts2<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 10cm  anomaly (°C)", x_col="Ts2", y_col = "FCH4_sum")
g_ch4_ts2
g_ch4_ts3<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 15cm  anomaly (°C)", x_col="Ts3", y_col = "FCH4_sum")
g_ch4_ts3
g_ch4_ts4<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 30cm  anomaly (°C)", x_col="Ts4", y_col = "FCH4_sum")
g_ch4_ts4
g_ch4_ts5<- plotter_monthly_anomalies(list(halm_month,deg_month,sto_month,hals_month), x_label = "Monthly Ts 50cm  anomaly (°C)", x_col="Ts5", y_col = "FCH4_sum")
g_ch4_ts5
figure <- ggarrange(g_ch4_gpp,g_ch4_ts,g_ch4_wtd,g_ch4_PARin, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
annotate_figure(figure, left = textGrob("Monthly CH4 flux anomaly (mg. m-2. d-1)", rot = 90, vjust = 1, gp = gpar(cex = 1)))
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png", height=30,width=15, units = "cm")
ggsave("D:/EC/Data_organized/Graphs_all/anomalies.png",
plot = annotate_figure(figure, left = textGrob("Monthly CH4 flux anomaly (mg. m-2. d-1)", rot = 90, vjust = 1, gp = gpar(cex = 1))),
height=30,width=15, units = "cm")
library(devtools)
load_all()
library(dplyr)
library(lubridate)
library(zoo)
library(ggpubr)
library(grid)
#Halmyran
halm_aggr_ch4 <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/aggr_rds.RDS")
halm_aggr_biomet <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/aggr_biomet.RDS")
halm_aggr_co2 <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/CO2/aggr_rds_CO2.RDS")
halm_aggr_h2o <- readRDS("D:/EC/Data_organized/Halmyran/FINAL/H2O/aggr_rds_H2O.RDS")
#Degero
deg_aggr_ch4 <- readRDS("D:/EC/Data_organized/Degero/FINAL/aggr_rds.RDS")
deg_aggr_biomet <- readRDS("D:/EC/Data_organized/Degero/FINAL/aggr_biomet.RDS")
deg_aggr_co2 <- readRDS("D:/EC/Data_organized/Degero/FINAL/CO2/aggr_rds_CO2.RDS")
deg_aggr_h2o <- readRDS("D:/EC/Data_organized/Degero/FINAL/H2O/aggr_rds_H2O.RDS")
#Stortjarn
sto_aggr_ch4 <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/aggr_rds.RDS")
sto_aggr_biomet <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/aggr_biomet.RDS")
sto_aggr_co2 <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/CO2/aggr_rds_CO2.RDS")
sto_aggr_h2o <- readRDS("D:/EC/Data_organized/Stortjarn/FINAL/H2O/aggr_rds_H2O.RDS")
#Halsingfors
hals_aggr_ch4 <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/aggr_rds.RDS")
hals_aggr_biomet <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/aggr_biomet.RDS")
hals_aggr_co2 <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/CO2/aggr_rds_CO2.RDS")
hals_aggr_h2o <- readRDS("D:/EC/Data_organized/Halsingfors/FINAL/H2O/aggr_rds_H2O.RDS")
################################
#######Monthly anomalies########
################################
#Reading all and getting daily values
halm_month <- Reduce(function(...) merge(..., all=TRUE), list(halm_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
halm_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
halm_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
halm_aggr_biomet$month)) %>% mutate(Site="Halmyran", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
deg_month <- Reduce(function(...) merge(..., all=TRUE), list(deg_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
deg_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
deg_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
deg_aggr_biomet$month)) %>% mutate(Site="Degero", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
sto_month <- Reduce(function(...) merge(..., all=TRUE), list(sto_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
sto_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
sto_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
sto_aggr_biomet$month)) %>% mutate(Site="Stortjarn", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
hals_month <- Reduce(function(...) merge(..., all=TRUE), list(hals_aggr_ch4$flux_df_month %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
hals_aggr_co2$flux_df_month %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
hals_aggr_h2o$flux_df_month %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
hals_aggr_biomet$month)) %>% mutate(Site="Halsingfors", PARin_f=PARin_f/1000, WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% arrange(yearmon) %>%
mutate(period = rep((1:ceiling(nrow(.)/12)), each=12)[1:nrow(.)],
GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs"))
library(ggcorrplot)
install.paclages(ggcorplot)
install.packages(ggcorplot)
install.packages("ggcorplot")
install.packages("ggcorrplot")
library(ggcorrplot)
View(cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs"))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
##Halmyran
halm_day <- Reduce(function(...) merge(..., all=TRUE), list(halm_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
halm_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
halm_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
halm_aggr_biomet$day))
halm_day$doy <- yday(halm_day$date)
halm_day$year <- year(halm_day$date)
plotter_3D(df=halm_day %>% filter(year==2021), x_var="Ts_f", y_var="GPP_sum", z_var="FCH4_sum", col_var="doy")
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
halm_day %>% select(-c(date,Site))
hals_day <- Reduce(function(...) merge(..., all=TRUE), list(hals_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
hals_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
hals_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
hals_aggr_biomet$day)) %>% mutate(Site="Halsingfors", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
###########################
#############################"
#Plotting all daily
#Reading all and getting daily values
halm_day <- Reduce(function(...) merge(..., all=TRUE), list(halm_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
halm_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
halm_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
halm_aggr_biomet$day)) %>% mutate(Site="Halmyran", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
deg_day <- Reduce(function(...) merge(..., all=TRUE), list(deg_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
deg_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
deg_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
deg_aggr_biomet$day)) %>% mutate(Site="Degero", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
sto_day <- Reduce(function(...) merge(..., all=TRUE), list(sto_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
sto_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
sto_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
sto_aggr_biomet$day)) %>% mutate(Site="Stortjarn", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(is.na(GPP_sum), na.approx(GPP_sum), GPP_sum)) %>%
mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
hals_day <- Reduce(function(...) merge(..., all=TRUE), list(hals_aggr_ch4$flux_df_day %>% rename(meas_err_ch4 = meas_err, tot_err_ch4 = tot_err),
hals_aggr_co2$flux_df_day %>% rename(meas_err_NEE = meas_err, tot_err_NEE = tot_err),
hals_aggr_h2o$flux_df_day %>% rename(meas_err_h2o = meas_err, tot_err_h2o = tot_err),
hals_aggr_biomet$day)) %>% mutate(Site="Halsingfors", PARin_f=PARin_f/1000, month = month(date), WTD_f = replace(WTD_f, month %in% c(12,1:4), NA)) %>%
select(-SNOWd) %>% mutate(GPP_sum = ifelse(GPP_sum < 0, 0, GPP_sum))
g_ch4 <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="CH4 fluxes (mg. m-2. d-1)", y_col = "FCH4_sum", show_x_label = FALSE)
g_gpp <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="GPP (gC. m-2. d-1)", y_col = "GPP_sum", show_x_label = FALSE)
g_Ta <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="Ta (°C)", y_col = "Ta_f", show_x_label = FALSE)
g_Ts <- plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="Ts (°C)", y_col = "Ts_f", show_x_label = FALSE)
g_PAR <-plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label=bquote(PARin*({10^3}*xW.m-2)), y_col = "PARin_f", show_x_label = FALSE)
g_WTD <-plotter_daily(list(halm_day,deg_day,sto_day,hals_day), y_label="WTD (cm)", y_col = "WTD_f", show_x_label = TRUE)
ggarrange(g_ch4,g_gpp,g_Ta,g_Ts,g_PAR,g_WTD, ncol = 1, common.legend = TRUE, align = "v", heights = c(1,1,1,1,1,1.45))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
View(cor((halm_day %>% select(-c(date,Site))), use = "complete.obs"))
halm_month_cormat <- cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs")
halm_month_cormat <- cor((halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs")
halm_day_cormat <- cor((halm_day %>% select(-c(date,Site))), use = "complete.obs")
has_day_cormat <- cor((hals_day %>% select(-c(date,Site))), use = "complete.obs")
ggcorrplot(halm_month_cormat, method="circle")
ggcorrplot(halm_month_cormat, method="circle", pch=1)
ggcorrplot(halm_month_cormat, method="circle", pch=0.2)
ggcorrplot(halm_month_cormat, method="circle", cex=0.2)
ggcorrplot(halm_month_cormat, method="circle", pch.cex=0.2)
ggcorrplot(halm_month_cormat, method="square", pch.cex=0.2)
halm_month_cormat <- cor((halm_month %>% select(c(FCH4_sum,NEE_sum,GPP_sum,Reco_SUM,H2O_sum,WTD_f,Ts1,Ts2,Ts3,Ts4,Ts5,PARin_f))), use = "complete.obs")
halm_month_cormat <- cor((halm_month %>% select(c(FCH4_sum,NEE_sum,GPP_sum,Reco_sum,H2O_sum,WTD_f,Ts1,Ts2,Ts3,Ts4,Ts5,PARin_f))), use = "complete.obs")
ggcorrplot(halm_month_cormat, method="square", pch.cex=0.2)
ggcorrplot(halm_month_cormat, method="circle", pch.cex=0.2)
ggcorrplot(halm_month_cormat, method="circle", hc.order = TRUE, type = "lower",
outline.col = "white")
ggcorrplot(halm_month_cormat, method="circle", type = "lower",
outline.col = "white")
ggcorrplot(halm_month_cormat, method="circle", type = "lower",
outline.col = "black")
ggcorrplot(halm_month_cormat, method="circle", type = "lower",
outline.col = "white")
ggcorrplot(halm_month_cormat, method="circle", type = "lower",
outline.col = "white", show.diag = TRUE)
?hclust
ggcorrplot(halm_month_cormat, method="circle", type = "lower", hc.order = TRUE,
outline.col = "white", show.diag = TRUE)
ggcorrplot(halm_month_cormat, method="circle", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE)
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE)
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE,
p.mat = p.mat)
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE,
p.mat = halm_month_cormat)
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE,
p.mat = cor_pmat(halm_month))
halm_month_sel <- halm_month %>% select(-c(year,month,yearmon,Site,period))), use = "complete.obs")
halm_month_sel <- (halm_month %>% select(c(FCH4_sum,NEE_sum,GPP_sum,Reco_sum,H2O_sum,WTD_f,Ts1,Ts2,Ts3,Ts4,Ts5,PARin_f))
halm_month_sel <- halm_month %>% select(c(FCH4_sum,NEE_sum,GPP_sum,Reco_sum,H2O_sum,WTD_f,Ts1,Ts2,Ts3,Ts4,Ts5,PARin_f))
halm_month_cormat <- cor(halm_month_sel, use = "complete.obs")
halm_month_sel <- halm_month %>% select(c(FCH4_sum,NEE_sum,GPP_sum,Reco_sum,H2O_sum,WTD_f,Ts1,Ts2,Ts3,Ts4,Ts5,PARin_f))
halm_month_cormat <- cor(halm_month_sel, use = "complete.obs")
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE,
p.mat = cor_pmat(halm_month_sel))
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE, lab_size = 0.2,
p.mat = cor_pmat(halm_month_sel))
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE, lab_size = 0.8,
p.mat = cor_pmat(halm_month_sel))
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE, lab_size = 2,
p.mat = cor_pmat(halm_month_sel))
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE, lab_size = 3,
p.mat = cor_pmat(halm_month_sel))
ggcorrplot(halm_month_cormat, method="square", type = "lower", hc.order = FALSE,
outline.col = "white", show.diag = TRUE,lab = TRUE, lab_size = 2.5,
p.mat = cor_pmat(halm_month_sel))
use_r("plotter_correlogram")
use_package("ggcorrplot")
